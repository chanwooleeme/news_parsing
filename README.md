# 경제 뉴스 분류 테스트 결과

본 프로젝트는 경제 뉴스 기사를 자동으로 분류하기 위한 다양한 임베딩 모델과, 키워드 가중치 및 페널티 조합을 테스트하고 결과를 분석한 것입니다.

## 테스트 구성

### 임베딩 모델
- `text-embedding-3-small`
- `text-embedding-3-large`

### 변형 설정
1. **기본 설정**: 기본 경제 키워드, 페널티 없음
2. **추가 경제 단어**: 확장된 경제 키워드 목록, 페널티 없음
3. **절충형**: 기본 경제 키워드, 정치/사회 키워드에 페널티 적용
4. **혼합형 1**: 확장된 경제 키워드 목록, 정치/사회 키워드에 강한 페널티 적용
5. **혼합형 2**: 확장된 경제 키워드 목록, 정치/사회 키워드에 중간 페널티 적용
6. **혼합형 3**: 확장된 경제 키워드 목록, 정치/사회 키워드에 약한 페널티 적용

### 데이터셋
- **output.json**: 실제 크롤링된 뉴스 기사 데이터
- **llm_output.json**: LLM으로 생성된 가상 뉴스 기사 데이터

## 주요 결과

### 1. 임베딩 모델 비교
두 임베딩 모델(small과 large)은 거의 동일한 성능을 보였습니다:
- `text-embedding-3-small`: 평균 F1 점수 82.87
- `text-embedding-3-large`: 평균 F1 점수 82.87

이는 더 작고 효율적인 `text-embedding-3-small` 모델만으로도 충분한 성능을 얻을 수 있음을 의미합니다.

### 2. 변형 설정 비교
|변형|설명|평균 F1 점수|
|---|---|---|
|혼합형 1|확장된 경제 키워드 목록, 정치/사회 키워드에 강한 페널티 적용|84.47|
|절충형|기본 경제 키워드, 정치/사회 키워드에 페널티 적용|83.95|
|추가 경제 단어|확장된 경제 키워드 목록, 페널티 없음|82.99|
|혼합형 3|확장된 경제 키워드 목록, 정치/사회 키워드에 약한 페널티 적용|82.52|
|혼합형 2|확장된 경제 키워드 목록, 정치/사회 키워드에 중간 페널티 적용|81.95|
|기본 설정|기본 경제 키워드, 페널티 없음|81.34|

전체적으로 **혼합형 1** 설정이 가장 높은 평균 F1 점수(84.47)를 기록했습니다.

### 3. 데이터셋 비교
- **output.json** (실제 데이터): 평균 F1 점수 85.40
- **llm_output.json** (LLM 생성 데이터): 평균 F1 점수 80.34

실제 크롤링된 데이터가 LLM으로 생성된 데이터보다 약 5.06 포인트 높은 성능을 보였습니다.

### 4. 데이터셋별 최적 변형
- **output.json**: '기본 설정' - F1 점수 87.16
- **llm_output.json**: '혼합형 1' - F1 점수 82.69

흥미롭게도 실제 데이터에서는 단순한 '기본 설정'이 가장 효과적이었으나, LLM 생성 데이터에서는 '혼합형 1'이 더 효과적이었습니다.

## 최고 성능 조합

- **모델**: text-embedding-3-small
- **변형**: 기본 설정 (기본 경제 키워드, 페널티 없음)
- **데이터셋**: output.json (실제 크롤링 데이터)
- **성능 지표**:
  - F1 점수: 87.16
  - 정밀도: 82.28
  - 재현율: 92.66

## 결론 및 권장사항

1. **모델 선택**: 경제 기사 분류에 `text-embedding-3-small` 모델 사용을 권장합니다. Large 모델과 동일한 성능을 보이면서 비용과 처리 시간이 더 적습니다.

2. **변형 선택**: 
   - 실제 데이터에는 '기본 설정'을 사용하는 것이 가장 효과적입니다.
   - LLM 생성 데이터에는 '혼합형 1'을 사용하는 것이 권장됩니다.
   
3. **특이 사항**:
   - 실제 데이터에서는 단순한 경제 키워드만으로도 효과적인 분류가 가능하며, 추가 키워드나 페널티가 오히려 성능을 저하시킬 수 있습니다.
   - LLM 생성 데이터는 실제 뉴스 기사의 특성을 완벽히 모방하지 못하고 있으며, 다른 분류 전략이 필요할 수 있습니다.

## 테스트 실행 방법

테스트를 재현하려면:

```bash
# 변형 테스트 실행
python test/run_variational_tests.py

# 결과 분석
python analyze_results.py
```

# 뉴스 파싱 및 경제 리포트 생성 파이프라인

## 프로젝트 개요
이 프로젝트는 뉴스 기사를 수집, 분석하여 경제 리포트를 자동으로 생성하는 Airflow 기반 파이프라인입니다.

## 시스템 요구사항
- Docker
- Docker Compose
- Python 3.8+

## 파이프라인 구조
```
news_pipeline_dag
├── download: 뉴스 기사 HTML 다운로드
├── parse: 기사 파싱 및 중복 제거
├── predict: 경제 관련 기사 분류
└── upload_to_s3: HTML 파일 S3 업로드

daily_economy_report_dag
├── retrieve_news: 최근 경제 뉴스 조회
├── check_sufficient: 충분한 기사 수 확인
├── generate_card_reports: 카드 리포트 생성
├── format_to_markdown: 마크다운 포맷 변환
├── save_report: 리포트 저장
├── convert_md_to_html: HTML 변환
├── upload_to_s3: S3 업로드
└── send_to_slack: 슬랙 알림 전송
```

## 시작하기

1. 환경 변수 설정
```bash
cp .env.example .env
# .env 파일에 필요한 환경 변수 설정
```

2. 서비스 시작
```bash
docker-compose up -d
```

3. Airflow 웹 인터페이스 접속
- URL: http://localhost:8080
- 기본 계정: admin/admin

## 주요 기능
- 뉴스 기사 자동 수집 및 파싱
- 중복 기사 제거 (MinHash + Redis)
- 경제 관련 기사 분류
- 일일 경제 리포트 자동 생성
- S3 저장 및 슬랙 알림

## 디렉토리 구조
```
.
├── pipeline/
│   ├── dags/          # Airflow DAG 파일
│   ├── tasks/         # 태스크 구현
│   └── utils/         # 유틸리티 함수
├── data/              # 데이터 저장
├── logs/              # 로그 파일
└── src/              # 소스 코드
``` 